DROP SCHEMA IF EXISTS nemanjaboje;

CREATE SCHEMA  nemanjaboje
  DEFAULT CHARACTER SET utf8
  DEFAULT COLLATE utf8_unicode_ci;

USE nemanjaboje;


CREATE TABLE ARTIKL
(
	Sifra                 INTEGER PRIMARY KEY AUTO_INCREMENT,
	Opis                  VARCHAR(500) NULL,
	Cijena                NUMERIC(19,4) NOT NULL,
	IdProizvodjaca        INTEGER NULL,
	Naziv                 VARCHAR(50) NULL
)
AUTO_INCREMENT = 1000001;



CREATE TABLE ARTIKL_U_SKLADISTU
(
	Sifra                 INTEGER NOT NULL,
	IdPoslovnice          INTEGER NOT NULL,
	Kolicina              INTEGER NOT NULL
)
;



ALTER TABLE ARTIKL_U_SKLADISTU
	ADD  PRIMARY KEY (Sifra,IdPoslovnice)
;



CREATE TABLE AUTO
(
	Sifra                 INTEGER NOT NULL,
	Boja                  VARCHAR(20) NULL,
	Potrosnja             VARCHAR(20) NULL,
	Pakovanje             VARCHAR(20) NULL
)
;



ALTER TABLE AUTO
	ADD  PRIMARY KEY (Sifra)
;



CREATE TABLE BANKOVNI_RACUN
(
	BrojRacuna            VARCHAR(50) NULL
)
;



ALTER TABLE BANKOVNI_RACUN
	ADD  PRIMARY KEY (BrojRacuna)
;



CREATE TABLE DNEVNI_PROMET
(
	Datum                 DATE NULL,
	Iznos                 NUMERIC(19,4) NOT NULL,
	IdPoslovnice          INTEGER NOT NULL
)
;



ALTER TABLE DNEVNI_PROMET
	ADD  PRIMARY KEY (Datum,IdPoslovnice)
;



CREATE TABLE DOBAVLJAC
(
	ID                    INTEGER NOT NULL
)
;



ALTER TABLE DOBAVLJAC
	ADD  PRIMARY KEY (ID)
;



CREATE TABLE ENTERIJER
(
	Sifra                 INTEGER NOT NULL,
	Boja                  VARCHAR(20) NULL,
	Potrosnja             VARCHAR(20) NULL,
	Pakovanje             VARCHAR(20) NULL,
	Rok_upotrebe          DATE NULL
)
;



ALTER TABLE ENTERIJER
	ADD  PRIMARY KEY (Sifra)
;



CREATE TABLE FAKTURA_KUPOVINA
(
	BrojFakture           INTEGER PRIMARY KEY AUTO_INCREMENT,
    DatumKupovine         DATE NOT NULL,
	BrojRacuna            INTEGER NULL,
    ID                    INTEGER NOT NULL,
	IdPoslovnice          INTEGER NOT NULL
)
;






CREATE TABLE FAKTURA_NABAVKA
(
	BrojFakture           INTEGER PRIMARY KEY AUTO_INCREMENT,
	DatumNabavke          DATE NOT NULL,
	UkupanIznos           NUMERIC(19,4) DEFAULT 0,
    ID                    INTEGER NOT NULL,
	IdPoslovnice          INTEGER NOT NULL

)
;




CREATE TABLE FARBA
(
	Sifra                 INTEGER NOT NULL,
	Vrsta                 VARCHAR(20) NULL,
	Boja                  VARCHAR(20) NULL,
	Pakovanje             VARCHAR(20) NULL,
	Potrosnja             VARCHAR(20) NULL
)
;



ALTER TABLE FARBA
	ADD  PRIMARY KEY (Sifra)
;



CREATE TABLE FASADA
(
	Sifra                 INTEGER NOT NULL,
	Boja                  VARCHAR(20) NULL,
	Potrosnja             VARCHAR(20) NULL,
	Pakovanje             VARCHAR(20) NULL
)
;



ALTER TABLE FASADA
	ADD  PRIMARY KEY (Sifra)
;



CREATE TABLE FISKALNI_RACUN
(
	BrojRacuna            INTEGER PRIMARY KEY AUTO_INCREMENT,
	Datum                 DATE NOT NULL,
	UkupanIznos           NUMERIC(19,4) DEFAULT 0,
	IdPoslovnice          INTEGER NOT NULL
)
;



CREATE TABLE ISPLATA_DOBAVLJACU
(
	BrojIsplate           INTEGER PRIMARY KEY AUTO_INCREMENT,
	DatumIsplate          DATE NOT NULL,
	Iznos                 NUMERIC(19,4) NOT NULL,
	ID                    INTEGER NOT NULL,
	BrojRacunaPoslovnice  VARCHAR(50) NOT NULL,
	BrojFakture           INTEGER NOT NULL
)
;




CREATE TABLE ISPLATA_PLATE
(
  BrojIsplate          INTEGER PRIMARY KEY AUTO_INCREMENT,
  JMB                  CHAR(13)       NOT NULL,
  IdPoslovnice         INTEGER        NOT NULL,
  DatumIsplate         DATE           NOT NULL,
  Iznos                DECIMAL(19, 4) NOT NULL,
  BrojRacunaZaposlenog VARCHAR(50)    NOT NULL,
  BrojRacunaPoslovnice VARCHAR(50)    NOT NULL
)
;


CREATE TABLE KUPAC
(
	ID                    INTEGER NOT NULL
)
;



ALTER TABLE KUPAC
	ADD  PRIMARY KEY (ID)
;



CREATE TABLE NANOSENJE
(
	Nacin                 VARCHAR(20) NULL,
	Sifra                 INTEGER NOT NULL
)
;




CREATE TABLE PLOCICE
(
	Sifra                 INTEGER NOT NULL,
	Vrsta                 VARCHAR(20) NULL,
	Dimenzije             VARCHAR(20) NULL
)
;



ALTER TABLE PLOCICE
	ADD  PRIMARY KEY (Sifra)
;



CREATE TABLE POSLOVNICA
(
	IdPoslovnice          INTEGER PRIMARY KEY AUTO_INCREMENT,
	Adresa                VARCHAR(100) NOT NULL,
	Telefon               VARCHAR(20) NOT NULL
)
;




CREATE TABLE PRAVNO_LICE
(
	ID                    INTEGER PRIMARY KEY AUTO_INCREMENT,
	Naziv                 VARCHAR(30) NOT NULL,
	BrojRacuna            VARCHAR(50) NOT NULL
)
;





CREATE TABLE PROIZVODJAC
(
	IdProizvodjaca        INTEGER PRIMARY KEY AUTO_INCREMENT,
	Naziv                 VARCHAR(50) NOT NULL
)
;




CREATE TABLE RACUN_POSLOVNICE
(
	BrojRacuna            VARCHAR(50) NOT NULL,
	IdPoslovnice          INTEGER NOT NULL
)
;



ALTER TABLE RACUN_POSLOVNICE
	ADD  PRIMARY KEY (BrojRacuna)
;



CREATE TABLE RACUN_ZAPOSLENOG
(
	BrojRacuna            VARCHAR(50) NOT NULL,
	JMB                   CHAR(13) NOT NULL
)
;



ALTER TABLE RACUN_ZAPOSLENOG
	ADD  PRIMARY KEY (BrojRacuna)
;



CREATE TABLE STAVKA_NABAVKE
(
	Sifra                 INTEGER NOT NULL,
	NabavnaCijena         NUMERIC(19,4) NOT NULL,
	Kolicina              INTEGER NOT NULL,
	BrojFakture           INTEGER NOT NULL
)
;



ALTER TABLE STAVKA_NABAVKE
	ADD  PRIMARY KEY (Sifra,BrojFakture)
;



CREATE TABLE STAVKA_RACUNA
(
	BrojRacuna            INTEGER NOT NULL,
	Sifra                 INTEGER NOT NULL,
	Kolicina              INTEGER NOT NULL,
	Cijena                NUMERIC(19,4) NULL
)
;



ALTER TABLE STAVKA_RACUNA
	ADD  PRIMARY KEY (BrojRacuna,Sifra)
;



CREATE TABLE TIP
(
	Vrsta                 VARCHAR(20) NULL
)
;



ALTER TABLE TIP
	ADD  PRIMARY KEY (Vrsta)
;



CREATE TABLE UGOVOR_POSAO
(
	JMB                   CHAR(13) NOT NULL,
	IdPoslovnice          INTEGER NOT NULL,
	DatumOd               DATE NOT NULL,
	DatumDo               DATE NULL
)
;



ALTER TABLE UGOVOR_POSAO
	ADD  PRIMARY KEY (JMB,IdPoslovnice)
;



CREATE TABLE UPLATA_KUPCA
(
	BrojUplate            INTEGER PRIMARY KEY AUTO_INCREMENT,
	BrojRacunaPoslovnice  VARCHAR(50) NOT NULL,
	ID                    INTEGER NOT NULL,
	Iznos                 NUMERIC(19,4) NOT NULL,
	DatumUplate           DATE NOT NULL,
	BrojFakture           INTEGER NOT NULL
)
;





CREATE TABLE UPLATA_PROMETA
(
	BrojUplate   INTEGER PRIMARY KEY AUTO_INCREMENT,
    IdPoslovnice INTEGER        NOT NULL,
    BrojRacuna   VARCHAR(50)    NOT NULL,
    Datum        DATE           NOT NULL,
    Iznos        NUMERIC(19, 4) NOT NULL
)
;


CREATE TABLE ZAPOSLENI
(
	JMB     CHAR(13)       NULL,
	Ime     VARCHAR(20)    NULL,
    Prezime VARCHAR(20)    NULL,
    Adresa  VARCHAR(50)    NULL,
    Telefon VARCHAR(20)    NULL,
    Plata   NUMERIC(19, 4) NOT NULL
)
;



ALTER TABLE ZAPOSLENI
	ADD  PRIMARY KEY (JMB)
;



ALTER TABLE ARTIKL
	ADD FOREIGN KEY R_38 (IdProizvodjaca) REFERENCES PROIZVODJAC(IdProizvodjaca)
;



ALTER TABLE ARTIKL_U_SKLADISTU
	ADD FOREIGN KEY R_43 (Sifra) REFERENCES ARTIKL(Sifra)
;


ALTER TABLE ARTIKL_U_SKLADISTU
	ADD FOREIGN KEY R_44 (IdPoslovnice) REFERENCES POSLOVNICA(IdPoslovnice)
;



ALTER TABLE AUTO
	ADD FOREIGN KEY (Sifra) REFERENCES ARTIKL(Sifra)
		ON DELETE CASCADE
;



ALTER TABLE DNEVNI_PROMET
	ADD FOREIGN KEY R_8 (IdPoslovnice) REFERENCES POSLOVNICA(IdPoslovnice)
;



ALTER TABLE DOBAVLJAC
	ADD FOREIGN KEY (ID) REFERENCES PRAVNO_LICE(ID)
		ON DELETE CASCADE
;



ALTER TABLE ENTERIJER
	ADD FOREIGN KEY (Sifra) REFERENCES ARTIKL(Sifra)
		ON DELETE CASCADE
;



ALTER TABLE FAKTURA_KUPOVINA
	ADD FOREIGN KEY R_68 (BrojRacuna) REFERENCES FISKALNI_RACUN(BrojRacuna)
;


ALTER TABLE FAKTURA_KUPOVINA
	ADD FOREIGN KEY R_92 (ID) REFERENCES KUPAC(ID)
;


ALTER TABLE FAKTURA_KUPOVINA
	ADD FOREIGN KEY R_93 (IdPoslovnice) REFERENCES POSLOVNICA(IdPoslovnice)
;



ALTER TABLE FAKTURA_NABAVKA
	ADD FOREIGN KEY R_90 (ID) REFERENCES DOBAVLJAC(ID)
;


ALTER TABLE FAKTURA_NABAVKA
	ADD FOREIGN KEY R_91 (IdPoslovnice) REFERENCES POSLOVNICA(IdPoslovnice)
;



ALTER TABLE FARBA
	ADD FOREIGN KEY (Sifra) REFERENCES ARTIKL(Sifra)
		ON DELETE CASCADE
;


ALTER TABLE FARBA
	ADD FOREIGN KEY R_88 (Vrsta) REFERENCES TIP(Vrsta)
;



ALTER TABLE FASADA
	ADD FOREIGN KEY (Sifra) REFERENCES ARTIKL(Sifra)
		ON DELETE CASCADE
;



ALTER TABLE FISKALNI_RACUN
	ADD FOREIGN KEY R_9 (IdPoslovnice) REFERENCES POSLOVNICA(IdPoslovnice)
;



ALTER TABLE ISPLATA_DOBAVLJACU
	ADD FOREIGN KEY R_24 (ID) REFERENCES DOBAVLJAC(ID)
;


ALTER TABLE ISPLATA_DOBAVLJACU
	ADD FOREIGN KEY R_32 (BrojRacunaPoslovnice) REFERENCES RACUN_POSLOVNICE(BrojRacuna)
;


ALTER TABLE ISPLATA_DOBAVLJACU
	ADD FOREIGN KEY R_26 (BrojFakture) REFERENCES FAKTURA_NABAVKA(BrojFakture)
;



ALTER TABLE ISPLATA_PLATE
	ADD FOREIGN KEY R_49 (BrojRacunaPoslovnice) REFERENCES RACUN_POSLOVNICE(BrojRacuna)
;


ALTER TABLE ISPLATA_PLATE
	ADD FOREIGN KEY R_95 (JMB,IdPoslovnice) REFERENCES UGOVOR_POSAO(JMB,IdPoslovnice)
;


ALTER TABLE ISPLATA_PLATE
	ADD FOREIGN KEY R_96 (BrojRacunaZaposlenog) REFERENCES RACUN_ZAPOSLENOG(BrojRacuna)
;



ALTER TABLE KUPAC
	ADD FOREIGN KEY (ID) REFERENCES PRAVNO_LICE(ID)
		ON DELETE CASCADE
;



ALTER TABLE NANOSENJE
	ADD FOREIGN KEY R_89 (Sifra) REFERENCES ARTIKL(Sifra)
;



ALTER TABLE PLOCICE
	ADD FOREIGN KEY (Sifra) REFERENCES ARTIKL(Sifra)
		ON DELETE CASCADE
;


ALTER TABLE PLOCICE
	ADD FOREIGN KEY R_87 (Vrsta) REFERENCES TIP(Vrsta)
;



ALTER TABLE PRAVNO_LICE
	ADD FOREIGN KEY R_23 (BrojRacuna) REFERENCES BANKOVNI_RACUN(BrojRacuna)
    ON DELETE CASCADE
;



ALTER TABLE RACUN_POSLOVNICE
	ADD FOREIGN KEY R_19 (BrojRacuna) REFERENCES BANKOVNI_RACUN(BrojRacuna)
    ON DELETE CASCADE
;


ALTER TABLE RACUN_POSLOVNICE
	ADD FOREIGN KEY R_20 (IdPoslovnice) REFERENCES POSLOVNICA(IdPoslovnice)
;



ALTER TABLE RACUN_ZAPOSLENOG
	ADD FOREIGN KEY R_50 (BrojRacuna) REFERENCES BANKOVNI_RACUN(BrojRacuna)
    ON DELETE CASCADE
;


ALTER TABLE RACUN_ZAPOSLENOG
	ADD FOREIGN KEY R_51 (JMB) REFERENCES ZAPOSLENI(JMB)
;



ALTER TABLE STAVKA_NABAVKE
	ADD FOREIGN KEY R_39 (Sifra) REFERENCES ARTIKL(Sifra)
;


ALTER TABLE STAVKA_NABAVKE
	ADD FOREIGN KEY R_41 (BrojFakture) REFERENCES FAKTURA_NABAVKA(BrojFakture)
;



ALTER TABLE STAVKA_RACUNA
	ADD FOREIGN KEY R_55 (BrojRacuna) REFERENCES FISKALNI_RACUN(BrojRacuna)
;


ALTER TABLE STAVKA_RACUNA
	ADD FOREIGN KEY R_56 (Sifra) REFERENCES ARTIKL(Sifra)
;



ALTER TABLE UGOVOR_POSAO
	ADD FOREIGN KEY R_45 (JMB) REFERENCES ZAPOSLENI(JMB)
;


ALTER TABLE UGOVOR_POSAO
	ADD FOREIGN KEY R_46 (IdPoslovnice) REFERENCES POSLOVNICA(IdPoslovnice)
;



ALTER TABLE UPLATA_KUPCA
	ADD FOREIGN KEY R_60 (BrojRacunaPoslovnice) REFERENCES RACUN_POSLOVNICE(BrojRacuna)
;


ALTER TABLE UPLATA_KUPCA
	ADD FOREIGN KEY R_61 (ID) REFERENCES KUPAC(ID)
;


ALTER TABLE UPLATA_KUPCA
	ADD FOREIGN KEY R_62 (BrojFakture) REFERENCES FAKTURA_KUPOVINA(BrojFakture)
;



ALTER TABLE UPLATA_PROMETA
	ADD FOREIGN KEY R_53 (BrojRacuna) REFERENCES RACUN_POSLOVNICE(BrojRacuna)
;


ALTER TABLE UPLATA_PROMETA
	ADD FOREIGN KEY R_54 (IdPoslovnice) REFERENCES POSLOVNICA(IdPoslovnice)
;


